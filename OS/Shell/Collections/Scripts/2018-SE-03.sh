# ÐÐ°Ð¿Ð¸ÑˆÐµÑ‚Ðµ ÑÐºÑ€Ð¸Ð¿Ñ‚, ÐºÐ¾Ð¹Ñ‚Ð¾ Ð¿Ñ€Ð¸ÐµÐ¼Ð° Ð´Ð²Ð° Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¾Ð½Ð½Ð¸ Ð°Ñ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ð° â€“ Ð¸Ð¼ÐµÐ½Ð° Ð½Ð° Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ð¸ Ñ„Ð°Ð¹Ð»Ð¾Ð²Ðµ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚
# Ð’Ð°Ð»Ð¸Ð´Ð½Ð¸ ÑÐ° ÑÐ»ÐµÐ´Ð½Ð¸Ñ‚Ðµ ÑƒÑÐ»Ð¾Ð²Ð¸Ñ:
# â€¢ CSV Ñ„Ð°Ð¹Ð»Ð¾Ð²ÐµÑ‚Ðµ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÑÐ²Ð°Ñ‚ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð°, ÐºÐ°Ñ‚Ð¾ Ð²ÑÐµÐºÐ¸ Ñ€ÐµÐ´ Ð½Ð° Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð°Ñ‚Ð° Ðµ Ð·Ð°Ð¿Ð¸ÑÐ°Ð½ Ð½Ð° Ð¾Ñ‚Ð´ÐµÐ»ÐµÐ½ Ñ€ÐµÐ´;
# â€¢ Ð½Ð° Ð´Ð°Ð´ÐµÐ½ Ñ€ÐµÐ´ Ð²ÑÑÐºÐ¾ Ð¿Ð¾Ð»Ðµ (ÐºÐ¾Ð»Ð¾Ð½Ð°) Ðµ Ñ€Ð°Ð·Ð´ÐµÐ»ÐµÐ½Ð¾ Ð¾Ñ‚ Ð¾ÑÑ‚Ð°Ð½Ð°Ð»Ð¸Ñ‚Ðµ ÑÑŠÑ Ð·Ð°Ð¿ÐµÑ‚Ð°Ñ;
# â€¢ Ð±Ñ€Ð¾ÑÑ‚ Ð½Ð°Ð¿Ð¾Ð»ÐµÑ‚Ð°Ñ‚Ð° Ð½Ð° Ð²ÑÐµÐºÐ¸ Ñ€ÐµÐ´ Ðµ ÐºÐ¾Ð½ÑÑ‚Ð°Ð½Ñ‚Ð°;
# â€¢ Ð²Ð¿Ð¾Ð»ÐµÑ‚Ð°Ñ‚Ð° Ð½Ðµ Ð¼Ð¾Ð¶ÐµÐ´Ð°Ð¿Ñ€Ð¸ÑÑŠÑÑ‚Ð²Ð° Ð·Ð°Ð¿ÐµÑ‚Ð°Ñ, Ñ‚.Ðµ., Ð·Ð°Ð¿ÐµÑ‚Ð°ÑÑ‚Ð° Ð²Ð¸Ð½Ð°Ð³Ð¸ Ðµ Ñ€Ð°Ð·Ð´ÐµÐ»Ð¸Ñ‚ÐµÐ» Ð¼ÐµÐ¶Ð´Ñƒ Ð¿Ð¾Ð»ÐµÑ‚Ð°;
# â€¢ Ð°ÐºÐ¾Ð²ÑŠÐ²Ñ„Ð°Ð¹Ð»Ð°Ð¿Ñ€Ð¸ÑÑŠÑÑ‚Ð²Ð°Ñ‚ Ð¸Ð½Ñ‚ÐµÑ€Ð²Ð°Ð»Ð¸, Ñ‚Ð¾ Ñ‚Ð¾Ð²Ð° ÑÐ° Ð´Ð°Ð½Ð½Ð¸ Ð¾Ñ‚ Ð´Ð°Ð´ÐµÐ½Ð¾ Ð¿Ð¾Ð»Ðµ;
# â€¢ Ð¿ÑŠÑ€Ð²Ð¾Ñ‚Ð¾ Ð¿Ð¾Ð»Ðµ Ð½Ð°Ð²ÑÐµÐºÐ¸ Ñ€ÐµÐ´ ÐµÑ‡Ð¸ÑÐ»Ð¾, ÐºÐ¾ÐµÑ‚Ð¾ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÑÐ²Ð° Ð¸Ð´ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ñ€ Ð½Ð° Ñ€ÐµÐ´Ð° (ID)
# Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ÑŠÑ‚ Ñ‚Ñ€ÑÐ±Ð²Ð° Ð´Ð° Ñ‡ÐµÑ‚Ðµ a.csv Ð¸ Ð½Ð° Ð½ÐµÐ³Ð¾Ð²Ð° Ð±Ð°Ð·Ð° Ð´Ð° ÑÑŠÐ·Ð´Ð°Ð²Ð° b.csv Ð¿Ð¾ ÑÐ»ÐµÐ´Ð½Ð¸Ñ Ð½Ð°Ñ‡Ð¸Ð½:
# â€¢ Ð½ÑÐºÐ¾Ð¸Ñ€ÐµÐ´Ð¾Ð²Ðµ Ð²ÑŠÐ² Ñ„Ð°Ð¹Ð»Ð° ÑÐµÑ€Ð°Ð·Ð»Ð¸Ñ‡Ð°Ð²Ð°Ñ‚ ÑÐ°Ð¼Ð¾ Ð¿Ð¾ ÐºÐ¾Ð»Ð¾Ð½Ð°Ñ‚Ð° ID, Ð¸ Ð·Ð° Ñ‚ÑÑ… ÐºÐ°Ð·Ð²Ð°Ð¼Ðµ, Ñ‡Ðµ Ñ„Ð¾Ñ€Ð¼Ð¸Ñ€Ð°Ñ‚ Ð¼Ð½Ð¾Ð¶ÐµÑÑ‚Ð²Ð¾ ð´ð‘–
# â€¢ Ð·Ð°Ð²ÑÑÐºÐ¾ Ñ‚Ð°ÐºÐ¾Ð²Ð° Ð¼Ð½Ð¾Ð¶ÐµÑÑ‚Ð²Ð¾ ð´ð‘– Ð´Ð° ÑÐµ Ð¾ÑÑ‚Ð°Ð²Ñ ÑÐ°Ð¼Ð¾ ÐµÐ´Ð¸Ð½ Ñ€ÐµÐ´- Ñ‚Ð¾Ð·Ð¸, Ñ Ð½Ð°Ð¹-Ð¼Ð°Ð»ÐºÐ° ÑÑ‚Ð¾Ð¹Ð½Ð¾ÑÑ‚ Ð½Ð° ID-Ñ‚Ð¾;
# â€¢ Ñ€ÐµÐ´Ð¾Ð²ÐµÑ‚Ðµ, ÐºÐ¾Ð¸Ñ‚Ð¾ Ð½Ðµ ÑÐ° Ñ‡Ð»ÐµÐ½Ð¾Ð²Ðµ Ð² Ð½ÑÐºÐ¾Ðµ Ð¼Ð½Ð¾Ð¶ÐµÑÑ‚Ð²Ð¾ ð´ð‘– ÑÐµ Ð·Ð°Ð¿Ð¸ÑÐ²Ð°Ñ‚ Ð² Ð¸Ð·Ñ…Ð¾Ð´Ð½Ð¸Ñ Ñ„Ð°Ð¹Ð» Ð±ÐµÐ· Ð¿Ñ€Ð¾Ð¼ÑÐ½Ð°

#!/bin/bash

if [[ $# -ne 2 ]]; then
	echo "Exactly two args needed"
	exit 1
fi

READ_FILE=$1
RES_FILE=$2

if [[ ! -f "$READ_FILE" ]]; then
	echo "Read file is nonexistant"
	exit 2 
fi

DIR_PATH=$(dirname "$RES_FILE")
if [ ! -d "$DIR_PATH" ]; then
    mkdir -p "$DIR_PATH"
fi

if [[ ! -f "$RES_FILE" ]]; then
    touch "$RES_FILE"
else
    > "$RES_FILE"
fi

while read UNIQ_ROW; do
	ROW_UID=$(grep "$UNIQ_ROW$" "$READ_FILE" | sort -t ',' -k 1 -n | head -n 1 | cut -d ',' -f 1)
 	echo "${ROW_UID},${UNIQ_ROW}" >> $RES_FILE
done < <(sed -E "s/^[0-9]+,//"  "$READ_FILE" | sort | uniq)
